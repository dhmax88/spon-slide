!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.sponResize={})}(this,function(e){"use strict";function t(e){return e=e||Object.create(null),{on:function(t,n){(e[t]||(e[t]=[])).push(n)},off:function(t,n){e[t]&&e[t].splice(e[t].indexOf(n)>>>0,1)},emit:function(t,n){(e[t]||[]).slice().map(function(e){e(n)}),(e["*"]||[]).slice().map(function(e){e(t,n)})}}}function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.map(function(e,n,r){return{PREV:r[n-1]?n-1:!0===t?r.length-1:n,NEXT:r[n+1]?n+1:!0===t?0:n}})},a=function(e,t,n){var r=!1,i=function n(i,o){if(o.stopPropagation(),t.removeEventListener(e,n),o.target===t&&!r)return r=!0,void i()};return new Promise(function(r){n&&n(),t.addEventListener(e,i.bind(null,r),!1)})},s=function(){var e=document.createElement("div");return function(t){return e.innerHTML=t,e.children[0]}}(),u=function(){var e={OAnimation:"oAnimationEnd",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",animation:"animationend"},t=document.createElement("fake");return Object.keys(e).reduce(function(n,r){return void 0!==t.style[r]?e[r]:n},"")},c=function(){var e=this;this.defaults={animationType:"animation",selector:"[data-slide-item]",previousButton:"[data-slide-prev]",nextButton:"[data-slide-next]",activeClass:"is-current",loop:!1,delay:3e3,wrap:!0,dots:!0,promiseBefore:!1,paginationParent:!1,animateOnInit:!1,startingIndex:function(){return 0},paginationWrapper:"<div></div>",paginationButtons:function(e){return e.map(function(){return"<button />"})}},this.setOptions=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.options=i({},e.options,{options:t}),e},this.init=function(){var t=e.options,r=t.selector,i=t.previousButton,a=t.nextButton,s=t.activeClass,u=t.loop,c=t.wrap,d=t.dots,l=t.startingIndex,p=t.animateOnInit,f=e.$el.querySelector("."+s);return e.$slides=[].concat(n(e.$el.querySelectorAll(r))),e.total=e.$slides.length-1,e.$prevBtn=i&&e.$el.querySelector(i),e.$nextBtn=a&&e.$el.querySelector("[data-slide-next]"),e.handle,e.timer,!f&&e.$slides[0].classList.add(s),e.startingIndex=l(e.$slides),e.machine=o(e.$slides,c),e.$prevBtn&&e.$prevBtn.addEventListener("click",e.prev),e.$nextBtn&&e.$nextBtn.addEventListener("click",e.next),e.currentIndex=e.startingIndex,d&&e._renderPager(e.startingIndex),u&&e._loop(),p&&e.goTo(e.startingIndex),e.started=!0,e},this.reset=function(){var t=e.option,r=t.selector,i=t.activeClass,a=t.loop,s=t.wrap,u=e.$nodes.indexOf(e.$el.querySelector("."+i));return a&&e._cancelLoop(),e.currentIndex=u>-1?u:0,e.$slides=[].concat(n(e.$el.querySelectorAll(r))),e.total=e.$slides.length-1,e.machine=o(e.$slides,s),e},this.destroy=function(){var t=e.option,n=t.activeClass,r=t.loop,i=t.dots;return r&&e._cancelLoop(),e.$prevBtn&&(e.$prevBtn.removeEventListener("click",e.prev),e.$prevBtn.removeAttribute("disabled")),e.$nextBtn&&(e.$nextBtn.removeEventListener("click",e.next),e.$nextBtn.removeAttribute("disabled")),i&&(e.$pagerButtons.forEach(function(t){return t.removeEventListener("click",e.onPagerClick)}),e.$pagerWrapper.parentNode.removeChild(e.$pagerWrapper)),e.$slides[e.currentIndex].classList.remove(n),e.$slides.forEach(function(e){return e.setAttribute("data-slide-item")}),e.$slides=[],e.off("*"),e},this.prev=function(t){t&&t.preventDefault(),e._transition(e.currentIndex,"PREV")},this.next=function(t){t&&t.preventDefault(),e._transition(e.currentIndex,"NEXT")},this.before=function(t){return e.options.promiseBefore?new Promise(function(n){e.emit("spon:before",{props:t,resolve:n})}):Promise.resolve()},this.goTo=function(t){if(log(t),!(e.currentIndex===t&&e.started||e.isRuning)){e.isRuning=!0;var n=e.options,r=n.activeClass,o=n.loop,s=n.animationType,c=n.dots,d=n.wrap,l=(t>e.currentIndex||0===t&&e.currentIndex===e.total)&&!(t===e.total&&0===e.currentIndex),p=e.$slides[e.currentIndex],f=e.$slides[t],v={direction:l?"forwards":"backwards",currentEl:p,nextEl:f},m=i({},v,{newIndex:t,currentIndex:e.currentIndex});d||e._updateButtonStates(t),"custom"!==s?e.before(i({},m)).then(function(){e.emit("spon:change",m),e.$slides.filter(function(n,r){return r!==e.currentIndex&&r!==t}).forEach(function(e){return e.setAttribute("data-slide-item","")}),a(u(),p,function(){p.classList.remove(r),p.setAttribute("data-slide-item",l?"hide-prev":"hide-next")}).then(function(){e.emit("spon:after",v)}),e.isRuning=!1,o&&(e._cancelLoop(),e._loop()),f.classList.add(r),f.setAttribute("data-slide-item",l?"show-next":"show-prev"),c&&e._updatePagerButtons(t),e.currentIndex=t}):e.before(m).then(function(){c&&e._updatePagerButtons(t),e.emit("spon:after",v),e.currentIndex=t,e.isRuning=!1,o&&(e._cancelLoop(),e._loop())})}},this._transition=function(t,n){var r=e.machine[t][n];e.emit("spon:"+n.toLowerCase(),{current:e.currentIndex,next:r,slides:e.$slides}),e.goTo(r)},this._updateButtonStates=function(t){var n=0===t,r=t===e.total;e.$prevBtn[n?"setAttribute":"removeAttribute"]("disabled",n),e.$nextBtn[r?"setAttribute":"removeAttribute"]("disabled",r)},this._onPagerClick=function(t){e._updatePagerButtons(t),e.goTo(t)},this._updatePagerButtons=function(t){e.$pagerButtons[e.currentIndex].setAttribute("data-slide-pager",""),e.$pagerButtons[t].setAttribute("data-slide-pager","active")},this._renderPager=function(t){var n=e.options,r=n.paginationParent,i=n.paginationWrapper,o=n.paginationButtons,a=r||e.$el;e.$pagerWrapper=a.appendChild(s(i)),e.$pagerButtons=o(e.$slides).map(function(e){return s(e)}).map(function(n,r){return n.setAttribute("data-slide-pager",r===t?"active":""),n.addEventListener("click",e._onPagerClick.bind(e,r)),n}),e.$pagerWrapper.appendChild(e.$pagerButtons.reduce(function(e,t){return e.appendChild(t),e},document.createDocumentFragment()))},this._loop=function(){var t=e.options.delay;e.timer=setTimeout(function(){e.handle=requestAnimationFrame(e._loop),e.next()},t)},this._cancelLoop=function(){cancelAnimationFrame(e.handle),clearTimeout(e.timer)}};e.animationEnd=u,e.default=function e(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),c.call(this),this.options=i({},this.defaults,o),this.$el=n,Object.assign(this,t())},Object.defineProperty(e,"__esModule",{value:!0})});
